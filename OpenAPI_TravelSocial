openapi: 3.0.3

info:
  title: TravelSocial API
  desciption: API for TravelSocial
  version: 1.0.0

servers:
  - url: https://api.example.com

components:
  security: 
    bearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

  schemas:
    Post:
      type: object
      properties:
        id: 
          type: string
          format: guid
        text: 
          type: string
        user_id:
          type: string
          format: guid
        account_id:
          type: string
          format: guid
        location_link:
          type: string
        created_time:
          type: string
          format: date-time
          example: "2025-04-05T12:00:00Z"
        comments:
          type: array
          items:
            $ref: "#/components/schemas/Comment"
    Comment:
      type: object
      properties:
        id:
          type: string
          format: guid
        account_id:
          type: string
          format: guid
        text:
          type: string
        attachments:
          type: string
          format: guid
        created_time: 
          type: string
          format: date-time
          example: "2025-04-05T12:00:00Z"
        change_time:
          type: string
          format: date-time
          example: "2025-04-05T12:00:00Z"
    Search:
      type: object
      properties:
        location-name:
          type: string
          example: "Paris, Louvre"
    Subscribe:
      type: object
      properties:
        id:
          type: string
          format: guid
        reader_id:
          type: string
          format: guid
        author_id:
          type: string
          format: guid
    GetUserPageRequest:
      type: object
      properties:
        posts:
          type: array
          items:
            $ref: "#/components/schemas/Post"
    CreatePostRequest:
      type: object
      properties:
        text: 
          type: string
        user_id:
          type: string
          format: guid
        account_id:
          type: string
          format: guid
        location_link:
          type: string
    UpdatePostRequest:
      type: object
      properties:
        id:
          type: string
          format: guid
        text: 
          type: string
        location_link:
          type: string
    CreatedAnswer:
      type: object
      properties:
        answer_type:
          type: string
          example: "Created"
        message:
          type: string
          example: "Created"
    DeleteAnswer:
      type: object
      properties:
        post_id:
          type: string
          format: guid
    AuthorizationError:
      type: object
      properties:
        error_type:
          type: string
          example: "Unauthorized"
        message:
          type: string
          example: "JWT token not valid"
    NotFoundError:
      type: object
      properties:
        error_type:
          type: string
          example: "Not found"
        message:
          type: string
          example: "Api path not found"
    ForbiddenError:
      type: object
      properties:
        error_type:
          type: string
          example: "Forbidden"
        message:
          type: string
          example: "Forbidden execute this request"
    ServerError:
      type: object
      properties:
        error_type:
          type: string
          example: "Server error"
        message:
          type: string
          example: "Error when try send request to the server"

paths:
  "users/{user_id}/{post_id}":
    get:
      summary: "Get post by id"
      security: 
        - bearerAuth: []
      parameters:
        - name: id
          in: query
          description: Post id
          required: false
          schema: 
            type: string
            format: guid
      responses:
        "200":
          description: Finded post result info
          content:
            application/json:
              schema:
                type: object  
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Post"
        "401":
          description: Not authorized
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/AuthorizationError"
        "403":
          description: Forbidden
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ForbiddenError"
        "404":
          description: Not Found
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/NotFoundError"
        "500":
          description: Server error
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ServerError" 
    delete:
      summary: "Delete post by id"
      security: 
        - bearerAuth: []
      parameters:
        - name: id
          in: query
          description: Post id
          required: true
          schema: 
            type: string
            format: guid
      responses:
        "200":
          description: Deleted post id
          content:
            application/json:
              schema:
                type: object  
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/DeleteAnswer"
        "401":
          description: Not authorized
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/AuthorizationError"
        "403":
          description: Forbidden
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ForbiddenError"
        "404":
          description: Not Found
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/NotFoundError"
        "500":
          description: Server error
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ServerError" 
    put:
      summary: "Update post by id"
      security: 
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UpdatePostRequest"  
      responses:
        "200":
          description: Created post result info
          content:
            application/json:
              schema:
                type: object  
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Post"
        "401":
          description: Not authorized
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/AuthorizationError"
        "403":
          description: Forbidden
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ForbiddenError"
        "404":
          description: Not Found
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/NotFoundError" 
        "500":
          description: Server error
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ServerError"   
  "users/{user_id}/post":
    post:
      summary: "Create post"
      security: 
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/CreatePostRequest"
      responses:
        "200":
          description: Created post result info
          content:
            application/json:
              schema:
                type: object  
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Post"
        "201":
          description: Created
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/CreatedAnswer"
        "401":
          description: Not authorized
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/AuthorizationError"
        "403":
          description: Forbidden
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ForbiddenError"
        "404":
          description: Not Found
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/NotFoundError" 
        "500":
          description: Server error
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ServerError" 
  "users/{user_id}/page":
    get:
      summary: Get user page by user id
      security: 
        - bearerAuth: []
      parameters:
        - name: id
          in: query
          description: User account id
          schema: 
            type: string
            format: guid
        - name: page
          in: query
          description: User page number
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: Posts limit on page
          schema: 
            type: integer
            default: 8
      responses:
        "200":
          description: Finded page result info
          content:
            application/json:
              schema:
                type: object  
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/GetUserPageRequest"
        "401":
          description: Not authorized
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/AuthorizationError"
        "403":
          description: Forbidden
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ForbiddenError"
        "404":
          description: Not Found
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/NotFoundError"
        "500":
          description: Server error
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ServerError" 
  "/file/{file_id}":
    get:
      summary: Get file by id
      security:
        - bearerAuth: []
      parameters:
        - name: id
          in: query
          description: File id
          schema: 
            type: string
            format: guid
      responses:
        "200":
          description: Finded file result info
          content:
            image/jpeg:
              schema:
                type: string
                format: binary
        "401":
          description: Not authorized
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/AuthorizationError"
        "403":
          description: Forbidden
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ForbiddenError"
        "404":
          description: Not Found
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/NotFoundError"
        "500":
          description: Server error
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ServerError" 
  "/file":
    post:
      summary: Add file
      security:
        - bearerAuth: []
      requestBody:
        content:
          multipart/form-data:
            schema:
              type: object
              properties:
                file:
                  type: string
                  format: binary
      responses:
        "200":
          description: File success added
          content:
            application/json:
              schema:
                type: string
                format: guid
        "401":
          description: Not authorized
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/AuthorizationError"
        "403":
          description: Forbidden
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ForbiddenError"
        "404":
          description: Not Found
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/NotFoundError"
        "500":
          description: Server error
          content:
            application/json:
              schema: 
                $ref: "#/components/schemas/ServerError" 
  "users/{user_id}/subscribe":
    get:
      summary: Get users subscribe
      security: 
        - bearerAuth: []
      parameters:
        - name: id
          in: query
          description: User subscribe
          schema: 
            type: string
            format: guid
        - name: limit
          in: query
          description: Posts limit on page
          schema: 
            type: integer
            default: 8
      responses: 
        "200":
          description: User subscribe Finded
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Subscribe"
    post:
      summary: Add subscribe
      security:
        - bearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/Subscribe" 
      responses: 
        "200":
          description: User subscribe Finded
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: array
                    items:
                      $ref: "#/components/schemas/Subscribe"
